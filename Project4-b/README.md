## Project 4(b): 验证SM3上的长度扩展攻击
### 原理
SM3的长度拓展攻击基于SM3的merkle结构以及HASH的长度拓展特性和消息扩展函数中存在的漏洞。攻击者可以利用消息扩展在输入中添加数据，从而由截获的中间状态来伪造受害者通过SM3正常加密的结果。

该攻击具体过程如下：

一、攻击者需要获取原始消息的摘要值，即已知的哈希结果H0，这是由原始消息M和IV经过压缩得到的部分信息。

二、攻击者准备一个扩展消息Q并构造Q的填充Q'。

三、攻击者利用Q'和H0迭代获得输出Vn。

四、经过数学推导，由Vn得到的一个哈希结果即为原始SM3对M加密的哈希结果H1。

攻击流程图如下：
<img width="621" height="287" alt="Flowchart" src="https://github.com/user-attachments/assets/4303b1a6-44ad-43fa-8101-6c8d33fdea66" />

### 代码说明
代码采用C++实现，其中已添加注释。

中间状态由对原始消息进行第一轮压缩得到，其获取在SM3()函数中，为便于结果展示，最终代码中将其进行了注释。
### 结果展示
<img width="987" height="167" alt="image" src="https://github.com/user-attachments/assets/c3103e68-33a3-48f0-a7b5-c39c659b5d4d" />

由图可见，我们进行攻击得到的哈希结果和正常SM3得到的哈希结果是完全一致的。
