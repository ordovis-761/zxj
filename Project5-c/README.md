## Project 5(c): satoshi数字签名伪造算法
### 原理
整个算法围绕椭圆曲线加密完成，假设椭圆曲线常规参数均已定义，则一般的签名算法为构造摘要 $e=Hash(m)$ 和坐标参数 $r=x(R) \mod n$ 后，计算 $s=k^{-1}(e+dr) \mod n$ ，之后构造签名(r,s)。

验证算法接收(r,s)后，结合m和公钥P计算 $w=s^{-1} \mod n$ 以及 $u=ew \mod n$ $v=rw \mod n$ 。

计算坐标点 $R'=uG+vP$ 后，确认等式 $r=x(R') \mod n$ 是否成立。

在常规的验证算法基础上，satoshi无消息签名算法可以对签名进行伪造以骗过验证算法，具体步骤如下：

一. 选定u，v和构造点R后，设定一个签名分量sp满足 $sp^{-1} \equiv vr^{-1} \pmod{m}$ 。

二. 反推摘要e以重建R'，这一步即找到v1和v2满足 $v1R+v2P=uG+vP=R'$,于是我们可以得到公式 $e=urv^{-1} \mod n$ 。

三. 整合总结出伪造的输出 $(r,s,e)=[x(uG+vP) \mod n,rv^{-1} \mod n,urv^{-1} \mod n]$ 。

四. 使用伪造输出参与校验，根据上述公式，即可发现伪造的输出能完美骗过验证算法，这种方案无需攻击者知晓原始消息m和正确私钥d。
### 代码思路
首先是实现简单椭圆曲线加密算法的基本函数，包括乘法逆元mul_inv(),点加算法add()以及标量乘法p_mul_n()。

之后按照上述公式，调用hash()函数生成摘要e后，实现ECDSA签名生成算法和验证算法。

为了验证无消息攻击，我们构造一个ver_no_m()函数，用于模拟未知m的情况下进行验证的过程。

最后构建pretend()伪造算法，根据数学原理找出对应点u,v和R，传入ver_no_m()中，判断验证是否能通过。
### 结果分析
<img width="795" height="196" alt="pretend_res" src="https://github.com/user-attachments/assets/b6954a28-f2d6-4fb5-bb8c-1e9d28eab954" />
由运行结果可以看到，我们构造的satoshi无消息伪造算法攻击成功，其能成功绕过签名算法的验证程序。
